

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>absfuyu.tools.passwordlib &mdash; ABSFUYU&#39;S DOCUMENTATION v5.1.0</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=bfa18cfb"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=b612fa2f"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            absfuyu
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../info.html">SUMMARY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../info.html#installation">INSTALLATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../info.html#usage">USAGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../info.html#development-setup">DEVELOPMENT SETUP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../info.html#license">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Module Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">absfuyu</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">absfuyu.tools.passwordlib</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for absfuyu.tools.passwordlib</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Absfuyu: Passwordlib</span>
<span class="sd">--------------------</span>
<span class="sd">Password library</span>

<span class="sd">Version: 5.1.0</span>
<span class="sd">Date updated: 10/03/2025 (dd/mm/yyyy)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># Module level</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PasswordGenerator&quot;</span><span class="p">,</span> <span class="s2">&quot;PasswordHash&quot;</span><span class="p">,</span> <span class="s2">&quot;TOTP&quot;</span><span class="p">]</span>


<span class="c1"># Library</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassVar</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">NamedTuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote</span><span class="p">,</span> <span class="n">urlencode</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.core.baseclass</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseClass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.core.docstring</span><span class="w"> </span><span class="kn">import</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">versionadded</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.dxt</span><span class="w"> </span><span class="kn">import</span> <span class="n">DictExt</span><span class="p">,</span> <span class="n">Text</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.pkg_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataList</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.tools.generator</span><span class="w"> </span><span class="kn">import</span> <span class="n">Charset</span><span class="p">,</span> <span class="n">Generator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">absfuyu.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_min</span>


<span class="c1"># Function</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;5.0.0&quot;</span><span class="p">)</span>
<span class="nd">@versionadded</span><span class="p">(</span><span class="s2">&quot;4.2.0&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_password_check</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verify the strength of ``password``.</span>
<span class="sd">    A password is considered strong if:</span>

<span class="sd">    - 8 characters length or more</span>
<span class="sd">    - 1 digit or more</span>
<span class="sd">    - 1 symbol or more</span>
<span class="sd">    - 1 uppercase letter or more</span>
<span class="sd">    - 1 lowercase letter or more</span>

<span class="sd">    :param password: Password want to be checked</span>
<span class="sd">    :type password: str</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># calculating the length</span>
    <span class="n">length_error</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span>

    <span class="c1"># searching for digits</span>
    <span class="n">digit_error</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d&quot;</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="c1"># searching for uppercase</span>
    <span class="n">uppercase_error</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[A-Z]&quot;</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="c1"># searching for lowercase</span>
    <span class="n">lowercase_error</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[a-z]&quot;</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="c1"># searching for symbols</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[ !#$%&amp;&#39;()*+,-./[</span><span class="se">\\</span><span class="s2">\]^_`{|}~&quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;&quot;]&#39;</span><span class="p">)</span>
    <span class="n">symbol_error</span> <span class="o">=</span> <span class="n">symbols</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="n">detail</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;length_error&quot;</span><span class="p">:</span> <span class="n">length_error</span><span class="p">,</span>
        <span class="s2">&quot;digit_error&quot;</span><span class="p">:</span> <span class="n">digit_error</span><span class="p">,</span>
        <span class="s2">&quot;uppercase_error&quot;</span><span class="p">:</span> <span class="n">uppercase_error</span><span class="p">,</span>
        <span class="s2">&quot;lowercase_error&quot;</span><span class="p">:</span> <span class="n">lowercase_error</span><span class="p">,</span>
        <span class="s2">&quot;symbol_error&quot;</span><span class="p">:</span> <span class="n">symbol_error</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Password error summary: </span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">length_error</span><span class="p">,</span>
            <span class="n">digit_error</span><span class="p">,</span>
            <span class="n">uppercase_error</span><span class="p">,</span>
            <span class="n">lowercase_error</span><span class="p">,</span>
            <span class="n">symbol_error</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>


<span class="c1"># Class</span>
<span class="c1"># ---------------------------------------------------------------------------</span>
<div class="viewcode-block" id="PasswordHash">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordHash">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PasswordHash</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Password hash</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    salt : bytes</span>
<span class="sd">        Salt</span>

<span class="sd">    key : bytes</span>
<span class="sd">        Key</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">salt</span><span class="p">:</span> <span class="nb">bytes</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span></div>



<div class="viewcode-block" id="PasswordGenerator">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordGenerator">[docs]</a>
<span class="nd">@versionadded</span><span class="p">(</span><span class="s2">&quot;4.2.0&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PasswordGenerator</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Password Generator&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span>

<div class="viewcode-block" id="PasswordGenerator.password_hash">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordGenerator.password_hash">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">password_hash</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PasswordHash</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate hash for password.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        password : str</span>
<span class="sd">            Password string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PasswordHash</span>
<span class="sd">            Password hash contains salt and key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">salt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">(</span>
            <span class="n">hash_name</span><span class="o">=</span><span class="s2">&quot;sha256&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span>
            <span class="n">iterations</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">PasswordHash</span><span class="p">(</span><span class="n">salt</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="PasswordGenerator.password_check">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordGenerator.password_check">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">password_check</span><span class="p">(</span><span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check password&#39;s characteristic.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        password : str</span>
<span class="sd">            Password string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Password&#39;s characteristic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">password</span><span class="p">)</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DictExt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">data</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


    <span class="c1"># Password generator</span>
<div class="viewcode-block" id="PasswordGenerator.generate_password">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordGenerator.generate_password">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_password</span><span class="p">(</span>
        <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">include_uppercase</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">include_number</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">include_special</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a random password.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        length : int</span>
<span class="sd">            | Length of the password.</span>
<span class="sd">            | Minimum value: ``8``</span>
<span class="sd">            | (Default: ``8``)</span>

<span class="sd">        include_uppercase : bool</span>
<span class="sd">            Include uppercase character in the password, by default ``True``</span>

<span class="sd">        include_number : bool</span>
<span class="sd">            Include digit character in the password, by default ``True``</span>

<span class="sd">        include_special : bool</span>
<span class="sd">            Include special character in the password, by default ``True``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Generated password</span>


<span class="sd">        Example:</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; Password.generate_password()</span>
<span class="sd">        [T&amp;b@mq2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charset</span> <span class="o">=</span> <span class="n">Charset</span><span class="o">.</span><span class="n">LOWERCASE</span>
        <span class="n">check</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">include_uppercase</span><span class="p">:</span>
            <span class="n">charset</span> <span class="o">+=</span> <span class="n">Charset</span><span class="o">.</span><span class="n">UPPERCASE</span>
            <span class="n">check</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">include_number</span><span class="p">:</span>
            <span class="n">charset</span> <span class="o">+=</span> <span class="n">Charset</span><span class="o">.</span><span class="n">DIGIT</span>
            <span class="n">check</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">include_special</span><span class="p">:</span>
            <span class="n">charset</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;[!#$%&amp;&#39;()*+,-./]^_`{|}~</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
            <span class="n">check</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">pwd</span> <span class="o">=</span> <span class="n">Generator</span><span class="o">.</span><span class="n">generate_string</span><span class="p">(</span>
                <span class="n">charset</span><span class="o">=</span><span class="n">charset</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="n">set_min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
                <span class="n">times</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">string_type_if_1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">analyze</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>  <span class="c1"># Count each type of char</span>

            <span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">analyze</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="n">check</span><span class="p">:</span>  <span class="c1"># Break loop if each type of char has atleast 1</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">pwd</span>  <span class="c1"># type: ignore</span></div>


<div class="viewcode-block" id="PasswordGenerator.generate_passphrase">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.PasswordGenerator.generate_passphrase">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_passphrase</span><span class="p">(</span>
        <span class="n">num_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">block_divider</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">first_letter_cap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">include_number</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">custom_word_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a random passphrase</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_of_blocks : int</span>
<span class="sd">            Number of word used, by default ``5``</span>

<span class="sd">        block_divider : str</span>
<span class="sd">            Character symbol that between each word, by default ``&quot;-&quot;``</span>

<span class="sd">        first_letter_cap : bool</span>
<span class="sd">            Capitalize first character of each word, by default ``True``</span>

<span class="sd">        include_number : bool</span>
<span class="sd">            Add number to the end of each word, by default ``True``</span>

<span class="sd">        custom_word_list : list[str] | None</span>
<span class="sd">            Custom word list for passphrase generation, by default uses a list of 360K+ words</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Generated passphrase</span>


<span class="sd">        Example:</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; print(Password().generate_passphrase())</span>
<span class="sd">        Myomectomies7-Sully4-Torpedomen7-Netful2-Begaud8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">words</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">DataLoader</span><span class="p">(</span><span class="n">DataList</span><span class="o">.</span><span class="n">PASSWORDLIB</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">custom_word_list</span>
            <span class="k">else</span> <span class="n">custom_word_list</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">block_divider</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">block_divider</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>

        <span class="n">dat</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_of_blocks</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">first_letter_cap</span><span class="p">:</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="n">dat</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">include_number</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_of_blocks</span><span class="p">))</span>
            <span class="n">dat</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">block_divider</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TOTP">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.TOTP">[docs]</a>
<span class="nd">@versionadded</span><span class="p">(</span><span class="s2">&quot;5.0.0&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TOTP</span><span class="p">(</span><span class="n">BaseClass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to represent a Time-based One-Time Password (TOTP) generator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    secret : str</span>
<span class="sd">        The shared secret key used to generate the TOTP.</span>

<span class="sd">    name : str, optional</span>
<span class="sd">        | The name associated with the TOTP.</span>
<span class="sd">        | If not provided, by default ``&quot;None&quot;``.</span>

<span class="sd">    issuer : str, optional</span>
<span class="sd">        The issuer of the TOTP.</span>

<span class="sd">    algorithm : Literal[&quot;SHA1&quot;, &quot;SHA256&quot;, &quot;SHA512&quot;], optional</span>
<span class="sd">        | The hashing algorithm used to generate the TOTP.</span>
<span class="sd">        | Must be one of ``&quot;SHA1&quot;``, ``&quot;SHA256&quot;``, or ``&quot;SHA512&quot;``.</span>
<span class="sd">        | By default ``&quot;SHA1&quot;``.</span>

<span class="sd">    digit : int, optional</span>
<span class="sd">        | The number of digits in the generated TOTP.</span>
<span class="sd">        | Must be greater than 0.</span>
<span class="sd">        | By default ``6``.</span>

<span class="sd">    period : int, optional</span>
<span class="sd">        | The time step in seconds for TOTP generation.</span>
<span class="sd">        | Must be greater than 0.</span>
<span class="sd">        | by default ``30``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">URL_SCHEME</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;otpauth://totp/&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">issuer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;SHA1&quot;</span><span class="p">,</span> <span class="s2">&quot;SHA256&quot;</span><span class="p">,</span> <span class="s2">&quot;SHA512&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SHA1&quot;</span><span class="p">,</span>
        <span class="n">digit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a TOTP instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        secret : str</span>
<span class="sd">            The shared secret key used to generate the TOTP.</span>

<span class="sd">        name : str, optional</span>
<span class="sd">            | The name associated with the TOTP.</span>
<span class="sd">            | If not provided, by default ``&quot;None&quot;``.</span>

<span class="sd">        issuer : str, optional</span>
<span class="sd">            The issuer of the TOTP.</span>

<span class="sd">        algorithm : Literal[&quot;SHA1&quot;, &quot;SHA256&quot;, &quot;SHA512&quot;], optional</span>
<span class="sd">            | The hashing algorithm used to generate the TOTP.</span>
<span class="sd">            | Must be one of ``&quot;SHA1&quot;``, ``&quot;SHA256&quot;``, or ``&quot;SHA512&quot;``.</span>
<span class="sd">            | By default ``&quot;SHA1&quot;``.</span>

<span class="sd">        digit : int, optional</span>
<span class="sd">            | The number of digits in the generated TOTP.</span>
<span class="sd">            | Must be greater than 0.</span>
<span class="sd">            | By default ``6``.</span>

<span class="sd">        period : int, optional</span>
<span class="sd">            | The time step in seconds for TOTP generation.</span>
<span class="sd">            | Must be greater than 0.</span>
<span class="sd">            | by default ``30``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issuer</span> <span class="o">=</span> <span class="n">issuer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">digit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># digit must be larger than 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># period must be larger than 0</span>

<div class="viewcode-block" id="TOTP.to_url">
<a class="viewcode-back" href="../../../absfuyu.tools.passwordlib.html#absfuyu.tools.passwordlib.TOTP.to_url">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a URL for the TOTP in the otpauth format.</span>

<span class="sd">        The URL format is as follows:</span>
<span class="sd">            ``otpauth://totp/&lt;name&gt;?secret=&lt;secret&gt;&amp;issuer=&lt;issuer&gt;&amp;algorithm=&lt;algorithm&gt;&amp;digit=&lt;digit&gt;&amp;period=&lt;period&gt;``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A URL representing the TOTP in otpauth format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;secret&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret</span><span class="p">,</span>
            <span class="s2">&quot;issuer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">issuer</span><span class="p">,</span>
            <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
            <span class="s2">&quot;digit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">digit</span><span class="p">,</span>
            <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># Filter out None values from the params dictionary</span>
        <span class="n">filtered_params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
        <span class="c1"># filtered_params = {k: v for k, v in self.__dict__.items() if v is not None}</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">filtered_params</span><span class="p">,</span> <span class="n">quote_via</span><span class="o">=</span><span class="n">quote</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">URL_SCHEME</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">tail</span><span class="si">}</span><span class="s2">&quot;</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, AbsoluteWinter.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>